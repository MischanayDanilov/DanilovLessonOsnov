/* Задание 5.1 */
use sakila;
select c.first_name, c.last_name, a.address, ct.city from customer c
inner join address a on c.address_id = a.address_id
inner join city ct
on a.city_id = ct.city_id
where a.district = 'California';

/* Задание 5.2 */
use sakila;
select f.title from film f
inner join film_actor fa on f.film_id = fa.film_id
inner join actor a on a.actor_id = fa.actor_id
where a.first_name = "JOHN";

/* Задание 5.3 */
use sakila;
select a.address, a2.address, c.city from address a
inner join address a2 on a.city_id  = a2.city_id
inner join city c on a.city_id = c.city_id
where a.address != a2.address;

/* id и адрес автомагазин, где есть товары стоимостью больше 1000 */
use Avtomagazin;
select m.id_Avtomagazina, m.Adres from avtomagaziny m 
inner join tovary t  on t.id_Avtomagazina = m.id_Avtomagazina 
where t.Stoimost > 1000;

/* Фио сотрудников с зарплатой меньше 20000 и адрес автомагазина в котором они работают*/
use Avtomagazin;
select s.id_Sotrudnika, s.Imya, s.Familiya, s.Otchestvo, s.Zarplata as `З/П`, m.Adres as `Адрес автомагазина` from sotrudniki s
inner join avtomagaziny m on s.id_Avtomagazina = m.id_Avtomagazina
where s.Zarplata < 20000;